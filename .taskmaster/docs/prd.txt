# 정신장애인 재활 목표 관리 플랫폼 - PRD v2.0

## 📌 Product Overview

### 제품명
정신장애인 재활 목표 관리 플랫폼 (Mental Health Rehabilitation Goal Management Platform)

### 제품 비전
정신장애인의 재활 과정을 체계적이고 과학적으로 관리하여, 환자의 실질적인 삶의 질 향상과 사회복지사의 업무 효율성을 극대화하는 AI 기반 통합 플랫폼

### 핵심 가치
- **구체성**: SMART 원칙 기반의 측정 가능한 목표 
- **개인화**: AI 기반 맞춤형 재활 계획 수립
- **효율성**: 자동화된 목표 관리 및 추적 시스템
- **신뢰성**: 데이터 무결성과 실시간 동기화 보장

## 🎯 Problem Statement

### 현재 문제점
1. **목표 설정의 추상성**: "프로그램 참여 잘하기"와 같은 구체성 없는 목표로 인한 낮은 동기부여
2. **수작업 의존**: 목표 설정부터 추적까지 모든 과정이 수기로 진행되어 비효율적
3. **데이터 단절**: 환자 진행 상황의 체계적 추적 및 분석 불가
4. **피드백 부재**: 목표 달성 과정에서의 실시간 피드백 및 조정 메커니즘 부족
5. **업무 과부하**: 사회복지사의 반복적인 문서 작업으로 인한 핵심 업무 시간 부족

### 목표 사용자
- **Primary User**: 병원 소속 정신과 사회복지사
- **Secondary User**: 시스템 관리자
- **Tertiary User**: 정신장애인 환자 (향후 확장)

## 🚀 Solution Overview

### 핵심 솔루션
1. **5단계 평가 시스템**: 환자의 현재 상태를 다각도로 평가
2. **AI 기반 목표 추천**: 평가 결과를 바탕으로 3가지 맞춤형 재활 계획 제시
3. **계층적 목표 관리**: 6개월 → 월간 → 주간 목표의 자동 생성 및 관리
4. **실시간 진행 추적**: 주간 체크인과 자동화된 진행률 계산
5. **데이터 기반 인사이트**: 환자별, 사회복지사별 성과 분석 대시보드

## 🧩 Core Features & User Stories

### 1. 환자 관리 (Patient Management)
**User Story**: "사회복지사로서, 환자의 기본 정보와 병력을 체계적으로 관리하고 싶다"

**기능 상세**:
- 환자 등록 및 기본 정보 입력
- 진단 정보 관리 (진단명, 진단일)
- 담당 사회복지사 배정
- 환자 상태 추적 (active, discharged)

**데이터 구조**: `patients` 테이블
- 환자 고유 식별자, 인적사항, 진단 정보, 연락처, 담당자 정보

### 2. 평가 시스템 (Assessment System)
**User Story**: "사회복지사로서, 환자의 현재 상태를 5가지 항목으로 평가하여 AI가 정확한 목표를 추천받을 수 있도록 하고 싶다"

**기능 상세**:
- 5가지 평가 항목:
  - 집중 가능 시간 (5분/15분/30분/1시간)
  - 동기 수준 (1-10점)
  - 과거 성공 경험 (복수 선택)
  - 제약사항 (복수 선택)
  - 사회적 선호도 (개인/소그룹/대그룹)
- 평가 이력 관리
- 평가 결과 시각화

**데이터 구조**: `assessments`, `assessment_options` 테이블

### 3. AI 목표 추천 (AI Goal Recommendation)
**User Story**: "사회복지사로서, 평가 결과를 바탕으로 AI가 추천하는 3가지 맞춤형 재활 계획을 받아보고 싶다"

**기능 상세**:
- N8N 워크플로우 웹훅을 통한 AI 분석
  - 평가 데이터를 웹훅으로 전송
  - N8N에서 데이터 처리 및 AI 분석 수행
  - 구조화된 재활 계획 수신
- 3가지 추천 계획 생성:
  - 각 계획별 6개월 목표 3개
  - 월간 목표 자동 분해
  - 주간 과제 자동 생성
- 수신된 데이터 파싱 및 표시
- 추천 계획 비교 및 선택 UI
- 선택된 계획으로 목표 자동 생성

**데이터 구조**: `ai_goal_recommendations` 테이블
- 평가 데이터 스냅샷, 추천 계획, 실행 전략 저장

### 4. 계층적 목표 관리 (Hierarchical Goal Management)
**User Story**: "사회복지사로서, 6개월 단위의 큰 목표가 월간, 주간 목표로 자동 분해되어 체계적으로 관리하고 싶다"

**기능 상세**:
- 3단계 목표 계층 구조:
  - 6개월 목표 (3개)
  - 월간 목표 (각 6개월 목표당 6개)
  - 주간 목표 (각 월간 목표당 4개)
- 목표별 카테고리 지정
- 우선순위 설정
- 상태 관리 (pending, active, completed, on_hold, cancelled)
- 목표 수정 이력 추적

**데이터 구조**: `rehabilitation_goals`, `goal_categories`, `goal_history` 테이블

### 5. 진행 상황 추적 (Progress Tracking)
**User Story**: "사회복지사로서, 주간 체크인을 통해 환자의 목표 달성 현황을 실시간으로 추적하고 싶다"

**기능 상세**:
- 주간 체크인 시스템:
  - 완료 여부 체크
  - 장애물 및 필요 지원 기록
  - 기분 평가 (1-5점)
- 자동 진행률 계산
- 상위 목표 진행률 자동 업데이트

**데이터 구조**: `weekly_check_ins`, `goal_evaluations` 테이블

### 6. 대시보드 및 분석 (Dashboard & Analytics)
**User Story**: "사회복지사로서, 담당 환자들의 전반적인 진행 상황을 한눈에 파악하고 싶다"

**기능 상세**:
- 사회복지사 대시보드:
  - 담당 환자 목록 및 진행 현황
  - 주간/월간 체크인 일정
  - 평균 달성률 및 추세
- 환자별 상세 분석:
  - 목표 달성률 추이
  - 평가 점수 변화
  - AI 추천 활용도
- 시스템 전체 통계 (관리자용)

**데이터 구조**: Views - `social_worker_dashboard`, `patient_current_progress`, `goal_metrics`

### 7. 서비스 기록 관리 (Service Records)
**User Story**: "사회복지사로서, 환자와의 상담 및 서비스 제공 내역을 체계적으로 기록하고 싶다"

**기능 상세**:
- 서비스 일시 및 소요 시간 기록
- 서비스 유형 및 카테고리 분류
- 개인/그룹 세션 구분
- 서비스 노트 작성

**데이터 구조**: `service_records` 테이블

## 🔧 Technical Architecture

### 기술 스택
- **Frontend**: React 18 + TypeScript + Tailwind CSS
- **State Management**: Tanstack Query (React Query)
- **Backend**: Supabase (PostgreSQL + Auth + Realtime)
- **AI Integration**: N8N Workflow Webhook
- **Automation**: N8N (AI 처리, 문서 자동화, 알림 등)
- **Development Tools**: 
  - IDE: Cursor
  - Hosting: Vercel/Replit
  - Testing: Playwright (E2E)

### 데이터베이스 설계
- **PostgreSQL** (Supabase 호스팅)
- **주요 테이블**: 13개 (사용자, 환자, 평가, 목표, AI 추천 등)
- **보안**: Row Level Security (RLS) 적용
- **최적화**: 복합 인덱스 및 계층적 쿼리 최적화

### API 설계
- **RESTful API** (Supabase auto-generated)
- **실시간 구독**: Supabase Realtime
- **인증**: JWT 기반 (Supabase Auth)

## 📊 Success Metrics (KPI)

### 정량적 지표
1. **사용률 지표**
   - AI 추천 기능 사용률 (목표: 80% 이상)
   - 주간 체크인 완료율 (목표: 90% 이상)

2. **성과 지표**
   - 목표 달성률 (목표: 60% 이상)
   - 환자 재활 계획 완수율
   - 조기 중단률 감소 (목표: 20% 감소)

### 정성적 지표
- 사회복지사 만족도 조사 (분기별)
- 시스템 사용성 평가 (SUS Score)
- 환자 피드백 (향후)

## 🚦 Implementation Roadmap

### Phase 1: MVP (4주)
**Week 1-2**: 기초 설정
- Supabase 프로젝트 설정 및 DB 스키마 구축
- 인증 시스템 구현
- 기본 UI 프레임워크 구축

**Week 3-4**: 핵심 기능
- 환자 등록 및 평가 시스템
- Dify API 연동 및 AI 추천 기능
- 목표 생성 및 기본 관리

### Phase 2: 핵심 기능 확장 (4주)
**Week 5-6**: 진행 추적
- 주간 체크인 시스템
- 진행률 자동 계산
- 목표 계층 구조 완성

**Week 7-8**: 대시보드
- 사회복지사 대시보드
- 환자별 상세 분석
- 데이터 시각화

### Phase 3: 고도화 (4주)
**Week 9-10**: 자동화 및 최적화
- N8N 연동 (문서 자동 생성)
- 성능 최적화
- 오류 처리 강화

**Week 11-12**: 안정화
- E2E 테스트 구현
- 사용자 피드백 반영
- 배포 및 모니터링 설정

## ⚠️ Risk Management

### 기술적 리스크
1. **데이터 일관성 문제**
   - 완화 방안: 트랜잭션 처리, 데이터 검증 로직 강화
   
2. **AI API 응답 지연**
   - 완화 방안: 캐싱 전략, 비동기 처리, 폴백 옵션

3. **확장성 문제**
   - 완화 방안: 초기 설계 시 확장성 고려, 모듈화

### 비즈니스 리스크
1. **사용자 저항**
   - 완화 방안: 단계적 도입, 충분한 교육, 지속적 피드백

2. **데이터 보안**
   - 완화 방안: RLS 적용, 정기 보안 감사, HIPAA 준수

## 🔮 Future Enhancements

### 단기 (3-6개월)
- 환자용 모바일 앱 개발
- 병원 EMR 시스템 연동
- 고급 분석 기능 (예측 모델)

### 장기 (6-12개월)
- 다기관 지원 (SaaS 전환)
- AI 모델 고도화 (자체 학습)
- 원격 재활 프로그램 통합

## 👥 Team & Responsibilities

### 프로젝트 오너
- **박승현**: 기획 및 개발 총괄

### 협력 필요 영역
- UI/UX 디자인 (외부 협력)
- 임상 자문 (정신과 전문의)
- QA 테스트 (사회복지사 참여)

## 📝 Appendix

### A. 데이터 보안 정책
- 환자 정보 암호화
- 접근 권한 관리 (RBAC)
- 정기적 백업 및 복구 계획

### B. 용어 정의
- **SMART 원칙**: Specific, Measurable, Achievable, Relevant, Time-bound
- **RLS**: Row Level Security
- **SUS**: System Usability Scale

### C. 참고 자료
- Supabase 공식 문서
- Dify API 문서
- 정신재활 가이드라인

---

**문서 버전**: v2.0  
**최종 수정일**: 2025-06-05  
**작성자**: 박승현  

**변경 이력**:
- v1.0 (2025-05-19): 초기 작성
- v1.1 ~ v1.5: 점진적 기능 추가 및 개선
- v2.0 (2025-06-05): 전면 재구성, DB 설계 통합, 실패 교훈 반영